<!DOCTYPE html>
<html lang="en" ng-app="loginApp">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">
    <title>Login-Form</title>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
</head>

<body>
    <header id="header">
        <div class="logo"><a href="">Minimal</a> </div>
        <div class="hamburger" id="toggle">
            <div class="line"></div>
            <div class="line"></div>
            <div class="line"></div>
        </div>
        <nav class="nav-bar" id="navbar">
            <ul>
                <li>
                    <a href="index.html">Home</a>
                </li>
                <li>
                    <a href="#product">Read List</a>
                </li>
                <li>
                    <a href="#about">Wishlist</a>
                </li>
                <li>
                    <a href="#contact">Contact</a>
                </li>
                <div class="login" id="login">
                    <li>
                        <a href="" class="navlogin">Login</a>
                    </li>
                </div>
            </ul>
        </nav>
    </header>
    <div class="container" id="home">
        <div class="login-left">
            <div class="login-header">
                <h1>Welcome</h1>
                <p>Please login to continue......</p>
            </div>
            <form action="" class="login-form" autocomplete="off" name="loginForm" ng-controller="loginCtrl"
                ng-submit="submitForm()">
                <div class="login-content">
                    <div class="form-item">
                        <label for="email">Enter Email</label>
                        <input type="email" name="email" id="email" placeholder="example@email.com" ng-model="email"
                            required>
                        <span ng-show="loginForm.email.$touched && loginForm.email.$error.required">Email is
                            required</span>
                        <span ng-show="loginForm.email.$touched && loginForm.email.$error.email">Invalid email
                            address</span>
                    </div>
                    <div class="form-item">
                        <label for="password">Enter Password</label>
                        <input type="password" name="password" id="password" placeholder="Enter your Password"
                            ng-model="password" required>
                        <span ng-show="loginForm.password.$touched && loginForm.password.$error.required">Password is
                            required</span>
                    </div>
                    <div class="form-item">
                        <div class="checkbox">
                            <input type="checkbox" name="" id="rememberMeCheckbox" checked>
                            <label for="rememberMeCheckbox" class="checkboxlabel">Remember Me</label>
                        </div>
                    </div>
                    <div class="remember-forgot">
                        <a href="#">Forgot password?</a>
                    </div>

                    <div class="bg-grey">
                        <div class="sing-up">Don't have an account? <a href="" class="text-link" id="sign-up">Sign
                                up</a></div>
                    </div>

                    <button type="submit">LogIn</button>
                </div>
                <div ng-show="errorMessage">{{ errorMessage }}</div>
                <!-- <div class="login-footer">
                    <a href="">
                        <img width="30" src="https://img.icons8.com/color/512/facebook-new.png" alt="facebook">Facebook
                    </a>
                    <a href="">
                        <img width="30" src="https://img.icons8.com/fluency/512/google-logo.png" alt="google">Google
                    </a>
                </div> -->
            </form>
        </div>
        <div class="login-right">
            <img src="images/Data Arranging_Two Color.svg" alt="">
        </div>
    </div>

    <script>
        console.log("soham is a great man!");
        var app = angular.module('loginApp', []);

        // AngularJS controller
        app.controller('loginCtrl', function ($scope, $http, $window) {
            $scope.submitForm = function () {
                if ($scope.loginForm.$valid) {
                    // Form is valid, perform login request
                    const userData = {
                        email: $scope.email,
                        password: $scope.password
                    };

                    console.log('Sending login request:', userData); // Log the request data

                    $http.post('/login', userData)
                        .then(response => {
                            console.log('Login response:', response.data); // Log the response data

                            // Successful login, check response message
                            if (response.data.message === 'Login successful') {
                                // Redirect to home page
                                $window.location.href = '/index.html';
                            } else {
                                // Display error message
                                $scope.errorMessage = response.data.message;
                            }
                        })
                        .catch(error => {
                            // Error during login, display error message
                            console.error('Error during login:', error);
                            $scope.errorMessage = 'An error occurred during login. Please try again later.';
                        });
                }
            };
        });
    </script>

</body>

</html>